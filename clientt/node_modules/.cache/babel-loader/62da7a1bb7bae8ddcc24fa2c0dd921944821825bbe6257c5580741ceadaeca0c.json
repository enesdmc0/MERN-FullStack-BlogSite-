{"ast":null,"code":"import _regeneratorRuntime from\"/home/enes/Desktop/16ocak lamadev bllog/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/enes/Desktop/16ocak lamadev bllog/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/enes/Desktop/16ocak lamadev bllog/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import\"./singlePost.css\";import axios from\"axios\";import{Link,useLocation}from'react-router-dom';import{useContext,useEffect,useState}from'react';import{Context}from'../../context/Context';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SinglePost=function SinglePost(){var location=useLocation();var path=location.pathname.split(\"/\")[2];var _useState=useState({}),_useState2=_slicedToArray(_useState,2),post=_useState2[0],setPost=_useState2[1];var PF=\"http://localhost:5000/images/\";var _useContext=useContext(Context),user=_useContext.user;var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),title=_useState4[0],setTitle=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),desc=_useState6[0],setDesc=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),updateMode=_useState8[0],setUpdateMode=_useState8[1];useEffect(function(){var getPost=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"/posts/\"+path);case 2:res=_context.sent;setPost(res.data);setTitle(res.data.title);setDesc(res.data.desc);case 6:case\"end\":return _context.stop();}},_callee);}));return function getPost(){return _ref.apply(this,arguments);};}();getPost();},[path]);var handleDelete=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.delete(\"/posts/\".concat(post._id),{data:{username:user.username}});case 3:window.location.replace(\"/\");_context2.next=8;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);case 8:case\"end\":return _context2.stop();}},_callee2,null,[[0,6]]);}));return function handleDelete(){return _ref2.apply(this,arguments);};}();var handleUpdate=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axios.put(\"/posts/\".concat(post._id),{username:user.username,title:title,desc:desc});case 3:setUpdateMode(false);_context3.next=8;break;case 6:_context3.prev=6;_context3.t0=_context3[\"catch\"](0);case 8:case\"end\":return _context3.stop();}},_callee3,null,[[0,6]]);}));return function handleUpdate(){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"singlePost\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"singlePostWrapper\",children:[post.photo&&/*#__PURE__*/_jsx(\"img\",{src:PF+post.photo,alt:\"\",className:\"singlePostImg\"}),updateMode?/*#__PURE__*/_jsx(\"input\",{autoFocus:true,type:\"text\",value:title,onChange:function onChange(e){return setTitle(e.target.value);},className:\"singlePostTitleInput\"}):/*#__PURE__*/_jsxs(\"h1\",{className:\"singlePostTitle\",children:[title,post.username===(user===null||user===void 0?void 0:user.username)&&/*#__PURE__*/_jsxs(\"div\",{className:\"singlePostEdit\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"singlePostIcon fa-regular fa-pen-to-square\",onClick:function onClick(){return setUpdateMode(true);}}),/*#__PURE__*/_jsx(\"i\",{className:\"singlePostIcon fa-solid fa-trash\",onClick:handleDelete})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"singlePostInfo\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"singlePostAuthor\",children:[\"Author:\",/*#__PURE__*/_jsx(Link,{className:\"link\",to:\"/?user=\".concat(post.username),children:/*#__PURE__*/_jsx(\"b\",{children:post.username})})]}),/*#__PURE__*/_jsx(\"span\",{className:\"singlePostDate\",children:new Date(post.createdAt).toDateString()})]}),updateMode?/*#__PURE__*/_jsx(\"textarea\",{value:desc,onChange:function onChange(e){return setDesc(e.target.value);},className:\"singlePostDescInput\"}):/*#__PURE__*/_jsx(\"p\",{className:\"singlePostDesc\",children:desc}),updateMode&&/*#__PURE__*/_jsx(\"button\",{className:\"singlePostButton\",onClick:handleUpdate,children:\"Update\"})]})});};export default SinglePost;","map":{"version":3,"names":["axios","Link","useLocation","useContext","useEffect","useState","Context","SinglePost","location","path","pathname","split","post","setPost","PF","user","title","setTitle","desc","setDesc","updateMode","setUpdateMode","getPost","get","res","data","handleDelete","delete","_id","username","window","replace","handleUpdate","put","photo","e","target","value","Date","createdAt","toDateString"],"sources":["/home/enes/Desktop/16ocak lamadev bllog/client/src/components/singlePost/SinglePost.jsx"],"sourcesContent":["import \"./singlePost.css\";\nimport axios from \"axios\";\nimport {Link, useLocation} from 'react-router-dom';\nimport {useContext, useEffect, useState} from 'react';\nimport {Context} from '../../context/Context';\nconst SinglePost = () => {\n    const location = useLocation();\n    const path = location.pathname.split(\"/\")[2];\n    const [post, setPost] = useState({});\n    const PF = \"http://localhost:5000/images/\"\n    const {user} = useContext(Context);\n    const [title, setTitle] = useState(\"\");\n    const [desc, setDesc] = useState(\"\");\n    const [updateMode, setUpdateMode] = useState(false);\n\n    useEffect(() => {\n        const getPost = async () => {\n                const res = await axios.get(\"/posts/\" + path);\n                setPost(res.data);\n                setTitle(res.data.title);\n                setDesc(res.data.desc);\n        }\n        getPost();\n    },[path])\n    const handleDelete = async () => {\n        try{\n            await axios.delete(`/posts/${post._id}`, {\n                data:{username: user.username}});\n            window.location.replace(\"/\");\n        }catch (err){}\n    }\n    const handleUpdate = async() => {\n        try{\n            await axios.put(`/posts/${post._id}`, {\n                username : user.username,\n                title,\n                desc,\n            });\n            setUpdateMode(false);\n        }catch (err){}\n    }\n\n    return (\n        <div className=\"singlePost\">\n            <div className=\"singlePostWrapper\">\n                {post.photo && (\n                    <img\n                        src={PF + post.photo}\n                        alt=\"\"\n                        className=\"singlePostImg\"/>\n                )}\n                {updateMode ? (<input autoFocus type=\"text\" value={title} onChange={(e) => setTitle(e.target.value)} className=\"singlePostTitleInput\"/>)\n                    : (\n                        <h1 className=\"singlePostTitle\">\n                            {title}\n                            {post.username === user?.username &&(\n                                <div className=\"singlePostEdit\">\n                                    <i className=\"singlePostIcon fa-regular fa-pen-to-square\" onClick={() => setUpdateMode(true)}></i>\n                                    <i className=\"singlePostIcon fa-solid fa-trash\" onClick={handleDelete}></i>\n                                </div>\n                            )}\n                        </h1>\n                    )}\n                <div className=\"singlePostInfo\">\n                    <span className=\"singlePostAuthor\">\n                        Author:\n                        <Link className=\"link\" to={`/?user=${post.username}`}>\n                            <b>{post.username}</b>\n                        </Link>\n                    </span>\n                    <span className=\"singlePostDate\">{new Date(post.createdAt).toDateString()}</span>\n                </div>\n                {updateMode ? (<textarea value={desc} onChange={(e) => setDesc(e.target.value)} className=\"singlePostDescInput\"/>) :\n                    (<p className=\"singlePostDesc\">\n                        {desc}\n                    </p>)}\n                {updateMode && (\n                    <button className=\"singlePostButton\" onClick={handleUpdate}>Update</button>)\n                }\n            </div>\n        </div>\n    )\n}\n\nexport default SinglePost;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}