{"ast":null,"code":"import _regeneratorRuntime from\"/home/enes/Desktop/16ocak lamadev bllog/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/enes/Desktop/16ocak lamadev bllog/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/enes/Desktop/16ocak lamadev bllog/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import\"./write.css\";import{useContext,useState}from'react';import axios from'axios';import{Context}from'../../context/Context';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Write=function Write(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),title=_useState2[0],setTitle=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),desc=_useState4[0],setDesc=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),file=_useState6[0],setFile=_useState6[1];var _useContext=useContext(Context),user=_useContext.user;var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var newPost,data,filename,res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();newPost={username:user.username,title:title,desc:desc};if(!file){_context.next=15;break;}data=new FormData();filename=Date.now()+file.name;data.append(\"name\",filename);data.append(\"file\",file);newPost.photo=filename;_context.prev=8;_context.next=11;return axios.post(\"/upload\",data);case 11:_context.next=15;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](8);case 15:_context.prev=15;_context.next=18;return axios.post(\"/posts\",newPost);case 18:res=_context.sent;window.location.replace(\"/post/\"+res.data._id);_context.next=24;break;case 22:_context.prev=22;_context.t1=_context[\"catch\"](15);case 24:case\"end\":return _context.stop();}},_callee,null,[[8,13],[15,22]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();console.log(user);return/*#__PURE__*/_jsxs(\"div\",{className:\"write\",children:[file&&/*#__PURE__*/_jsx(\"img\",{className:\"writeImg\",alt:\"\",src:URL.createObjectURL(file)}),/*#__PURE__*/_jsxs(\"form\",{className:\"writeForm\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"writeFormGroup\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"fileInput\",children:/*#__PURE__*/_jsx(\"i\",{className:\"writeIcon fa-solid fa-plus\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"fileInput\",style:{display:\"none\"},onChange:function onChange(e){return setFile(e.target.files[0]);}}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Title\",className:\"writeInput\",autoFocus:true,onChange:function onChange(e){return setTitle(e.target.value);}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"writeFormGroup\",children:/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Tell your story...\",type:\"text\",className:\"writeInput writeText\",onChange:function onChange(e){return setDesc(e.target.value);}})}),/*#__PURE__*/_jsx(\"button\",{className:\"writeSubmit\",type:\"submit\",children:\"Publish\"})]})]});};export default Write;","map":{"version":3,"names":["useContext","useState","axios","Context","Write","title","setTitle","desc","setDesc","file","setFile","user","handleSubmit","e","preventDefault","newPost","username","data","FormData","filename","Date","now","name","append","photo","post","res","window","location","replace","_id","console","log","URL","createObjectURL","display","target","files","value"],"sources":["/home/enes/Desktop/16ocak lamadev bllog/client/src/pages/write/Write.jsx"],"sourcesContent":["import \"./write.css\";\nimport {useContext, useState} from 'react';\nimport axios from 'axios';\nimport {Context} from '../../context/Context';\n\nconst Write = () => {\n    const [title, setTitle] = useState(\"\")\n    const [desc, setDesc] = useState(\"\")\n    const [file, setFile] = useState(null)\n    const {user} = useContext(Context);\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        const newPost = {\n            username : user.username,\n            title,\n            desc,\n        };\n        if (file){\n            const data = new FormData();\n            const filename = Date.now() + file.name;\n            data.append(\"name\", filename);\n            data.append(\"file\", file);\n            newPost.photo = filename;\n            try {\n                await axios.post(\"/upload\", data);\n            }catch (err) {}\n        }\n        try {\n            const res =await  axios.post(\"/posts\", newPost);\n            window.location.replace(\"/post/\" + res.data._id);\n        }catch (err){}\n    };\n    console.log(user)\n    return (\n        <div className=\"write\">\n            {file && (\n                <img\n                    className=\"writeImg\"\n                    alt=\"\"\n                    src={URL.createObjectURL(file)}/>\n            )}\n            <form className=\"writeForm\" onSubmit={handleSubmit}>\n                <div className=\"writeFormGroup\">\n                    <label htmlFor=\"fileInput\">\n                        <i className=\"writeIcon fa-solid fa-plus\"></i>\n                    </label>\n                    <input type=\"file\" id=\"fileInput\" style={{display:\"none\"}} onChange={e => setFile(e.target.files[0])}/>\n                    <input type=\"text\" placeholder=\"Title\" className=\"writeInput\" autoFocus={true} onChange={e => setTitle(e.target.value)}/>\n                </div>\n                <div className=\"writeFormGroup\">\n                    <textarea placeholder=\"Tell your story...\" type=\"text\" className=\"writeInput writeText\" onChange={e => setDesc(e.target.value)}></textarea>\n                </div>\n                <button className=\"writeSubmit\" type=\"submit\">Publish</button>\n            </form>\n        </div>\n    )\n}\n\nexport default Write;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}